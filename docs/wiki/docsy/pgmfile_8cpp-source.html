<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenRDK: pgmfile.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_c9084856de39d2370684ea5387345f28.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_96988b6434b62dfcbfa4cb8936cee763.html">libraries</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_2e4f2d31b959059e49dce94198a3cf84.html">rdkcore</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80b3a5da50a57e93ec9093d6eb437b4f.html">geometry</a>
  </div>
</div>
<div class="contents">
<h1>pgmfile.cpp</h1><a href="pgmfile_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *    OpenRDK : OpenSource Robot Development Kit</span>
<a name="l00003"></a>00003 <span class="comment"> *    Copyright (C) 2007, 2008  Daniele Calisi, Andrea Censi (&lt;first_name&gt;.&lt;last_name&gt;@dis.uniroma1.it)</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *    This program is free software: you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment"> *    it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment"> *    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment"> *    (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *    This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment"> *    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment"> *    GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> *    You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment"> *    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="logging_8h.html">rdkcore/logging/logging.h</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;<a class="code" href="textutils_8h.html">rdkcore/textutils/textutils.h</a>&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="filesystem_8h.html" title="Some common functions for manipulating files and filenames.">rdkcore/filesystem/filesystem.h</a>&gt;</span>
<a name="l00023"></a><a class="code" href="pgmfile_8cpp.html#abf8415093fb98fb0d75a21891caffed">00023</a> <span class="preprocessor">#define LOGGING_MODULE "PGMFile"</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="pgmfile_8h.html">pgmfile.h</a>"</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="keyword">namespace </span>RDK2 { <span class="keyword">namespace </span>Geometry {
<a name="l00027"></a>00027     <span class="keyword">using namespace </span>std;
<a name="l00028"></a>00028     <span class="keyword">using namespace </span>RDK2::Filesystem;
<a name="l00029"></a>00029     
<a name="l00030"></a><a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#4419d17cfff4d19d8a4fa4f3cc21455f">00030</a>     <span class="keywordtype">void</span> <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#21eaa403031b1fb92945c3684a4d17aa">PGMFile::load</a>(<span class="keyword">const</span> std::string&amp;file) <span class="keywordflow">throw</span>(runtime_error) {
<a name="l00031"></a>00031         ifstream ifs;
<a name="l00032"></a>00032         <a class="code" href="namespace_r_d_k2_1_1_filesystem.html#cc8ec9efc425474adf6284673931b534">fsOpenOrException</a>(ifs, file);
<a name="l00033"></a>00033         load(ifs);
<a name="l00034"></a>00034     }
<a name="l00035"></a>00035     
<a name="l00036"></a><a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#21eaa403031b1fb92945c3684a4d17aa">00036</a>     <span class="keywordtype">void</span> <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#21eaa403031b1fb92945c3684a4d17aa">PGMFile::load</a>(std::istream&amp;is) <span class="keywordflow">throw</span>(runtime_error) {
<a name="l00037"></a>00037         <span class="keywordtype">string</span> magicNumber;
<a name="l00038"></a>00038         is &gt;&gt; magicNumber;
<a name="l00039"></a>00039     
<a name="l00040"></a>00040         <span class="keywordflow">if</span>(magicNumber== <span class="stringliteral">"P5"</span>) {
<a name="l00041"></a>00041             this-&gt;type = P5;
<a name="l00042"></a>00042         } <span class="keywordflow">else</span> {
<a name="l00043"></a>00043             <span class="keywordtype">string</span> error = string(<span class="stringliteral">"Can not read file with magic number "</span>)+<a class="code" href="namespace_r_d_k2_1_1_text_utils.html#304e6b2f8abe1fb218db6c3d79296a8d">quote</a>(magicNumber)+<span class="stringliteral">"."</span>;
<a name="l00044"></a>00044             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00045"></a>00045             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00046"></a>00046         }
<a name="l00047"></a>00047         
<a name="l00048"></a>00048         this-&gt;comment = <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#57e6e1e0954ff0becba20a75b70ea7ac">RDK2::TextUtils::readCommentLines</a>(is);
<a name="l00049"></a>00049         <a class="code" href="logging_8h.html#8d456cb0185f5f07154f4db0dde9b1d6">RDK_DEBUG_STREAM</a>(<span class="stringliteral">"Read comment: "</span>&lt;&lt;<a class="code" href="namespace_r_d_k2_1_1_text_utils.html#304e6b2f8abe1fb218db6c3d79296a8d">quote</a>(comment));
<a name="l00050"></a>00050         
<a name="l00051"></a>00051         <span class="keywordflow">if</span>(!(is&gt;&gt;width)) {
<a name="l00052"></a>00052             <span class="keywordtype">string</span> error = <span class="stringliteral">"Could not read width."</span>;
<a name="l00053"></a>00053             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00054"></a>00054             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00055"></a>00055         }   
<a name="l00056"></a>00056         <a class="code" href="logging_8h.html#6f4aa8013e7d4fc57adf4c8cc494ae45">RDK_TRACE_PRINTF</a>(<span class="stringliteral">"Read width=%d"</span>, width);
<a name="l00057"></a>00057     
<a name="l00058"></a>00058         <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#fcd70915c5a8a8dfa9c4aa667e2275e4">RDK2::TextUtils::consumeWhitespace</a>(is); 
<a name="l00059"></a>00059         
<a name="l00060"></a>00060         <span class="keywordflow">if</span>(!(is&gt;&gt;height)) {
<a name="l00061"></a>00061             <span class="keywordtype">string</span> error = <span class="stringliteral">"Could not read height."</span>;
<a name="l00062"></a>00062             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00063"></a>00063             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00064"></a>00064         }   
<a name="l00065"></a>00065         <a class="code" href="logging_8h.html#6f4aa8013e7d4fc57adf4c8cc494ae45">RDK_TRACE_PRINTF</a>(<span class="stringliteral">"Read height=%d"</span>, height);
<a name="l00066"></a>00066     
<a name="l00067"></a>00067         <span class="keywordflow">if</span>(width&lt;=0 || height &lt;=0) {
<a name="l00068"></a>00068             <span class="keywordtype">string</span> error = string(<span class="stringliteral">"Bad width, height ="</span>)+<a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(width)+<span class="stringliteral">","</span>+<a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(height);
<a name="l00069"></a>00069             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00070"></a>00070             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00071"></a>00071         }
<a name="l00072"></a>00072     
<a name="l00073"></a>00073         <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#fcd70915c5a8a8dfa9c4aa667e2275e4">RDK2::TextUtils::consumeWhitespace</a>(is); 
<a name="l00074"></a>00074         <span class="keywordflow">if</span>(!(is&gt;&gt;this-&gt;maxVal)) {
<a name="l00075"></a>00075             <span class="keywordtype">string</span> error = <span class="stringliteral">"Could not read maxVal."</span>;
<a name="l00076"></a>00076             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00077"></a>00077             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00078"></a>00078         }   
<a name="l00079"></a>00079         <a class="code" href="logging_8h.html#6f4aa8013e7d4fc57adf4c8cc494ae45">RDK_TRACE_PRINTF</a>(<span class="stringliteral">"Read maxVal=%d"</span>, maxVal);
<a name="l00080"></a>00080     
<a name="l00081"></a>00081         <span class="keywordflow">if</span>(type == P5) {
<a name="l00082"></a>00082             <span class="keywordtype">int</span> <a class="code" href="dmatrix__pgm_8h.html#688a9e8c777085e9629fe1f284c00653">EXPECT_MAXVAL</a> = 255;
<a name="l00083"></a>00083             <span class="keywordflow">if</span>(maxVal!=EXPECT_MAXVAL) {
<a name="l00084"></a>00084                 <span class="keywordtype">string</span> error = <span class="stringliteral">"I expected a maxVal of "</span> + <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(EXPECT_MAXVAL)
<a name="l00085"></a>00085                     + <span class="stringliteral">" instead of "</span> + <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(maxVal);
<a name="l00086"></a>00086                 <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00087"></a>00087                 <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00088"></a>00088             }
<a name="l00089"></a>00089             is.get();
<a name="l00090"></a>00090             
<a name="l00091"></a>00091             <span class="keywordtype">int</span> rows    = height;
<a name="l00092"></a>00092             <span class="keywordtype">int</span> columns = width;
<a name="l00093"></a>00093             
<a name="l00094"></a>00094             this-&gt;buffer = <a class="code" href="class_r_d_k2_1_1_geometry_1_1_d_matrix.html">DMatrix&lt;int&gt;</a>(rows,columns);
<a name="l00095"></a>00095             <span class="comment">//int cold;</span>
<a name="l00096"></a>00096             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y=0;y&lt;height;y++)
<a name="l00097"></a>00097                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x=0;x&lt;width;x++)  {
<a name="l00098"></a>00098                     <span class="keywordtype">int</span> c = is.get();
<a name="l00099"></a>00099                     buffer[y][x] = c;
<a name="l00100"></a>00100                     
<a name="l00101"></a>00101                     <span class="comment">/*</span>
<a name="l00102"></a>00102 <span class="comment">                    if(c!=cold) {</span>
<a name="l00103"></a>00103 <span class="comment">                        RDK_INFO_STREAM("Read " &lt;&lt; buffer[y][x]);</span>
<a name="l00104"></a>00104 <span class="comment">                    }</span>
<a name="l00105"></a>00105 <span class="comment">                    cold = c;*/</span>
<a name="l00106"></a>00106                 }
<a name="l00107"></a>00107         } <span class="keywordflow">else</span> assert(<span class="keyword">false</span>);
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109     
<a name="l00110"></a><a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#0dec0cd63199ecbfd0530abbfcaf7af4">00110</a>     <span class="keywordtype">bool</span> <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#0dec0cd63199ecbfd0530abbfcaf7af4">PGMFile::load_</a>(<span class="keyword">const</span> std::string&amp;file) {
<a name="l00111"></a>00111         <span class="keywordflow">try</span> { <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#21eaa403031b1fb92945c3684a4d17aa">load</a>(file); <span class="keywordflow">return</span> <span class="keyword">true</span>; } <span class="keywordflow">catch</span>(exception&amp;e) {
<a name="l00112"></a>00112             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(e.what());
<a name="l00113"></a>00113             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116     
<a name="l00117"></a>00117     
<a name="l00118"></a>00118     
<a name="l00119"></a><a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#a381e84e2faeb7c1f3d6118d8edc40ca">00119</a>     <a class="code" href="class_r_d_k2_1_1_geometry_1_1_viewport.html">Viewport</a> PGMFile::getViewport(<span class="keywordtype">double</span> mapResolution) 
<a name="l00120"></a>00120         <span class="keywordflow">throw</span>(runtime_error, invalid_argument)
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122         <span class="keywordflow">if</span>(mapResolution &lt;0) {
<a name="l00123"></a>00123             <span class="keywordtype">string</span> error = string(<span class="stringliteral">"Invalid map resolution: "</span>)+<a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(mapResolution);
<a name="l00124"></a>00124             <span class="keywordflow">throw</span> invalid_argument(error);
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126         
<a name="l00127"></a>00127         <span class="keywordflow">if</span>(mapResolution == 0 &amp;&amp;
<a name="l00128"></a>00128             !readResolution(mapResolution)) {
<a name="l00129"></a>00129             <span class="keywordtype">string</span> error = string(<span class="stringliteral">"Could not read resolution inside comment: "</span>)+comment;
<a name="l00130"></a>00130             <span class="keywordflow">throw</span> runtime_error(error);
<a name="l00131"></a>00131         } <span class="keywordflow">else</span> {
<a name="l00132"></a>00132             <a class="code" href="logging_8h.html#8d456cb0185f5f07154f4db0dde9b1d6">RDK_DEBUG_STREAM</a>(<span class="stringliteral">"Map resolution: "</span>&lt;&lt;mapResolution);
<a name="l00133"></a>00133         }
<a name="l00134"></a>00134         
<a name="l00135"></a>00135         <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_point2.html">Point2d</a> rmin(0,0);
<a name="l00136"></a>00136         <a class="code" href="struct_r_d_k2_1_1_geometry_1_1_point2.html">Point2d</a> rmax(mapResolution * width, mapResolution * height); 
<a name="l00137"></a>00137         <span class="keywordflow">return</span> <a class="code" href="class_r_d_k2_1_1_geometry_1_1_viewport.html">Viewport</a>(rmin,rmax);
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139     
<a name="l00140"></a>00140     
<a name="l00141"></a><a class="code" href="namespace_r_d_k2_1_1_geometry.html#48a32bb1fd63e3a03cad216ccaadbbf3">00141</a>     <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespace_r_d_k2_1_1_geometry.html#48a32bb1fd63e3a03cad216ccaadbbf3">readVariable</a>(istream&amp;is, <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#fdf6da19875de4a1d2cce13f299ca4b9">cstr</a> name, T&amp;t) {
<a name="l00142"></a>00142         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00143"></a>00143         <span class="keywordtype">string</span> token;
<a name="l00144"></a>00144         <span class="keywordflow">while</span>(is&gt;&gt;token) 
<a name="l00145"></a>00145             <span class="keywordflow">if</span>(token==name) {
<a name="l00146"></a>00146                 is&gt;&gt;t;
<a name="l00147"></a>00147                 <span class="keywordflow">if</span>(!is.fail()) {
<a name="l00148"></a>00148                     found = <span class="keyword">true</span>; 
<a name="l00149"></a>00149                     <span class="keywordflow">break</span>; 
<a name="l00150"></a>00150                 }
<a name="l00151"></a>00151             }
<a name="l00152"></a>00152         <span class="keywordflow">return</span> found;
<a name="l00153"></a>00153     }
<a name="l00154"></a>00154     
<a name="l00155"></a><a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#8c1a4fc9982b42ca99a2db61e21794e8">00155</a>     <span class="keywordtype">bool</span> PGMFile::readResolution(<span class="keywordtype">double</span>&amp;mapResolution){
<a name="l00156"></a>00156         istringstream iss(<a class="code" href="struct_r_d_k2_1_1_geometry_1_1_p_g_m_file.html#92ef53f62f63db72076e89a77700abd1">comment</a>);
<a name="l00157"></a>00157         <span class="keywordflow">if</span>(!readVariable&lt;double&gt;(iss, <span class="stringliteral">"resolution"</span>, mapResolution)) {
<a name="l00158"></a>00158             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160         <span class="keywordflow">if</span>(mapResolution&lt;=0) {
<a name="l00161"></a>00161             <span class="keywordtype">string</span> error = string(<span class="stringliteral">"Invalid mapResolution: "</span>) + <a class="code" href="namespace_r_d_k2_1_1_text_utils.html#98aa4cfa55946ea4d1fe00c650f3b23a">toString</a>(mapResolution);
<a name="l00162"></a>00162             <a class="code" href="logging_8h.html#740a3a84230479c562d4017e03b1b00e">RDK_ERROR_STREAM</a>(error);
<a name="l00163"></a>00163             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167     
<a name="l00168"></a>00168         
<a name="l00169"></a>00169         
<a name="l00170"></a>00170 }} <span class="comment">// ns</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="comment">/*Each PGM image consists of the following:</span>
<a name="l00174"></a>00174 <span class="comment"></span>
<a name="l00175"></a>00175 <span class="comment">   1. A "magic number" for identifying the file type. A pgm image's magic number is the two characters "P5".</span>
<a name="l00176"></a>00176 <span class="comment">   2. Whitespace (blanks, TABs, CRs, LFs).</span>
<a name="l00177"></a>00177 <span class="comment">   3. A width, formatted as ASCII characters in decimal.</span>
<a name="l00178"></a>00178 <span class="comment">   4. Whitespace.</span>
<a name="l00179"></a>00179 <span class="comment">   5. A height, again in ASCII decimal.</span>
<a name="l00180"></a>00180 <span class="comment">   6. Whitespace.</span>
<a name="l00181"></a>00181 <span class="comment">   7. The maximum gray value (Maxval), again in ASCII decimal. Must be less than 65536, and more than zero.</span>
<a name="l00182"></a>00182 <span class="comment">   8. Newline or other single whitespace character.</span>
<a name="l00183"></a>00183 <span class="comment">   9. A raster of Height rows, in order from top to bottom. Each row consists of Width gray values, in order from left to right. Each gray value is a number from 0 through Maxval, with 0 being black and Maxval being white. Each gray value is represented in pure binary by either 1 or 2 bytes. If the Maxval is less than 256, it is 1 byte. Otherwise, it is 2 bytes. The most significant byte is first.</span>
<a name="l00184"></a>00184 <span class="comment"></span>
<a name="l00185"></a>00185 <span class="comment">      A row of an image is horizontal. A column is vertical. The pixels in the image are square and contiguous.</span>
<a name="l00186"></a>00186 <span class="comment">  10. Each gray value is a number proportional to the intensity of the pixel, adjusted by the CIE Rec. 709 gamma transfer function. (That transfer function specifies a gamma number of 2.2 and has a linear section for small intensities). A value of zero is therefore black. A value of Maxval represents CIE D65 white and the most intense value in the image and any other image to which the image might be compared.</span>
<a name="l00187"></a>00187 <span class="comment">  11. Note that a common variation on the PGM format is to have the gray value be "linear," i.e. as specified above except without the gamma adjustment. pnmgamma takes such a PGM variant as input and produces a true PGM as output.</span>
<a name="l00188"></a>00188 <span class="comment">  12. In the transparency mask variation on PGM, the value represents opaqueness. It is proportional to the fraction of intensity of a pixel that would show in place of an underlying pixel. So what normally means white represents total opaqueness and what normally means black represents total transparency. In between, you would compute the intensity of a composite pixel of an "under" and "over" pixel as under * (1-(alpha/alpha_maxval)) + over * (alpha/alpha_maxval). Note that there is no gamma transfer function in the transparency mask.</span>
<a name="l00189"></a>00189 <span class="comment">  13. Characters from a "#" to the next end-of-line, before the maxval line, are comments and are ignored. </span>
<a name="l00190"></a>00190 <span class="comment">  </span>
<a name="l00191"></a>00191 <span class="comment"> */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Mar 3 15:04:25 2009 for OpenRDK by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
